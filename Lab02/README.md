# CSC 748 - Software Exploitation
## Lab 02 Assignments

**Student Name:** Kiera Conway
**Due Date:** September 10, 2023

This folder contains lab files and scripts for the lab 02 buffer overflow challenges.

## Lab 2-1

	The exploit for this lab establishes a connection to a remote server and interacts with the binary, where it then exploits a vulnerability by sending a unique payload designed to overflow a buffer. The payload is comprised of 72 bytes of 'A' characters followed by the packed address of the "win" function. Once the payload is sent, the script enters an interactive session, which enables the user to interact with the compomised program and obtain the flag.


	Lab 2-1 Files:

		2-1_lab.bin:		binary file for lab 2-1
		2-1_exploit.py:		python script used to exploit Lab 2-1
		2-1_flag.png:		screenshot of successful script execution and flag retrieval



## Lab 2-2
	
	The exploit for this lab is similar to Lab 2-1, except there's no convenient "win()" function to directly call. Instead, this exploit must craft a custom shellcode, place it on the stack, and then manipulate the program to execute it. Similar to Lab 2-1, this is accomplished by sending a unique payload designed to overflow a buffer. However, this payload is comprised of 136 bytes of 'A' characters followed by the CALL_ESP address, SHELLCODE, and a newline character. Instead of jumping to a specific function (i.e 'win), the program is redirected to execute the shellcode. After the shellcode is successfully executed and a shell is granted, the script enters an interactive session, which enables the user to interact with the compomised program and obtain the flag.
	
	
	Lab 2-2 Files:
	
		2-2_lab.bin:				binary file for lab 2-2
		2-2_exploit.py:				python script used to exploit lab 2-2
		2-2_flag.png:				screenshot of successful script execution and flag retrieval



## Lab 2-3
	
	The exploit for Lab 2-3 builds on the concepts from the previous labs, with a main objective to exploit a buffer overflow vulnerability. However, this challenge equires some abstract thinking; instead of a single prompt to overflow, it continues to prompt the user until a -1 is entered. While the program does account for the buffer size of an entered string, it does not protect the stack from being overwritten when too many strings are entered. For example, if user input exceeds 8 bytes in a single string, the program crashes and restricts exploitation. However, by entering more than 14 separate strings, the stack begins to overwrite $RBP, return address, etc. Therefore, to successfully execute a buffer overflow, the exploit sends the payload in parts: first the buffer fill, then the opcode address (leveraging \x54\xc3 to represent 'push esp;ret'), followed by the shellcode, and finally the exit code.

	Another  complexity of this lab is that the input only accepts integers. Therefore, each portion of the payload needs to be converted to decimal format before being sent. To mitigate this, I converted each payload component seperately.	I converted the Buffer Filler values (0xAAAAAAAA and 0xBBBBBBBB) as well as the Opcode Address (0x4013d6) to their decimal equivalents externally and then incorporated their decimal values directly into the code. The Shellcode conversion, however, was more complicated. As such, I designed the 'input_conversion' function To streamline process. This function converts the binary string generated by 'asm(shellcraft.amd64.linux.sh())' into a list of decimal values, arranged as necessary for input. This approach allows the script to iterate through the list and submit each value individually. Once the shellcode is successfully executed and a shell is granted, the script enters an interactive session, allowing the user to interact with the compromised program and obtain the flag.
	
	Lab 2-3 Files:
	
		2-3_lab.bin:				binary file for lab 2-3
		2-3_exploit.py:				python script used to exploit Lab 2-3
		2-3_flag.png:				screenshot of successful script execution and flag retrieval


## Additional Notes

	- Each file is named in the format: "2-X_Title," where "X" corresponds to the lab number, and "Title" describes the file's purpose or content.
	
	- All python scripts require Python 3, pwntools
		> sudo apt-get install python3
		> pip install pwntools
		*installation instructions assume Linux-based systems*
		
	- scripts can be executed using the format `python3 programName`. For example:
		> python3 2-2_script.py
